{
  "app-id":"org.xonotic.Xonotic",
  "command":"xonotic-sdl",
  "runtime":"org.freedesktop.Platform",
  "runtime-version":"1.6",
  "sdk":"org.freedesktop.Sdk",
  "branch": "stable",
  "finish-args":[
    "--share=ipc",
    "--socket=x11",
    "--socket=wayland",
    "--device=dri",
    "--share=network",
    "--socket=pulseaudio",
    "--persist=.xonotic"
  ],
  "modules":[
    {
      "name":"Xonotic",
      "no-autogen": true,
      "make-args": [
        "all-zip-source"
      ],
      "make-install-args": [
        "PREFIX=/app"
      ],
      "sources":[
        {
          "type": "archive",
          "url": "http://dl.xonotic.org/xonotic-0.8.2.zip",
          "sha256": "a22f7230f486c5825b55cfdadd73399c9b0fae98c9e081dd8ac76eca08359ad5",
          "dest-filename": "xonotic.zip"
        },
        {
          "type": "patch",
          "path": "Makefile.patch",
          "strip-components": 0
        }
      ],
      "post-install": [
        "install -Dm755 source/gmqcc/gmqcc /app/bin/gmqcc",

        "install -dm755 /app/share/applications",
        "sed -e 's$Name=Xonotic (SDL)$Name=Xonotic$' -e 's$Icon=/usr/share/pixmaps/xonotic.png$Icon=org.xonotic.Xonotic$' -e 's$Exec=/usr/bin/xonotic-sdl$Exec=/app/bin/xonotic-sdl$' misc/logos/xonotic-sdl.desktop > /app/share/applications/org.xonotic.Xonotic.desktop",
        "sed -e 's$Icon=/usr/share/pixmaps/xonotic.png$Icon=org.xonotic.Xonotic$' -e 's$Exec=/usr/bin/xonotic-glx$Exec=/app/bin/xonotic-glx$' misc/logos/xonotic-glx.desktop > /app/share/applications/org.xonotic.Xonotic-glx.desktop",
        "for icon_size in 16 22 24 32 48 64 128 256 512; do
          install -d /app/share/icons/hicolor/${icon_size}x${icon_size}/apps
          install -m644 misc/logos/icons_png/xonotic_${icon_size}.png /app/share/icons/hicolor/${icon_size}x${icon_size}/apps/org.xonotic.Xonotic.png
        done"
      ]
    },
    {
      "name": "pkg-bits",
      "buildsystem": "simple",
      "sources": [
        {
          "type": "file",
          "path": "org.xonotic.Xonotic.appdata.xml"
        }
      ],
      "build-commands": [
        "install -Dm644 org.xonotic.Xonotic.appdata.xml /app/share/appdata/org.xonotic.Xonotic.appdata.xml"
      ]
    }
  ]
}
